{
  "metadata": {
    "evaluation_name": "Unified Synthesis: KW-PE Expressiveness vs Downstream Failure Gap Analysis",
    "description": "Synthesizes 4 experiments to explain why trajectory methods achieve 100% discrimination, why EDMD-based KW-PE fails downstream, and positions nRWPE as minimal spectral-invariance-breaking PE.",
    "analysis_1_ablation_decomposition": {
      "topology_attribution": 1.0,
      "walk_avg_rate": 1.0,
      "random_control_rate": 0.0,
      "nonlinearity_margin_boost": {
        "cospectral": 0.9867077588063047,
        "CSL": 1.0193348440124868,
        "strongly_regular": 1.0876820597172234,
        "BREC_Basic": 0.9878807040776201,
        "BREC_Regular": 0.9782329873065295,
        "BREC_Extension": 0.9905724494998227,
        "BREC_CFI": 0.9552968709426418,
        "BREC_4Vertex": 0.9275031572183186,
        "BREC_Distance_Regular": 1.081244397341847,
        "BREC_Strongly_Regular": 0.9961452714639968
      },
      "edmd_margin_effect": {
        "cospectral": 1.0624098848119234,
        "CSL": 1.0360635830871812,
        "strongly_regular": 1.0882808464940799,
        "BREC_Basic": 1.0407524724221617,
        "BREC_Regular": 1.000607782257617,
        "BREC_Extension": 1.0536513690701679,
        "BREC_CFI": 1.0068263540825046,
        "BREC_4Vertex": 0.8075903858260797,
        "BREC_Distance_Regular": 1.1222639308915772,
        "BREC_Strongly_Regular": 0.9770333812828589
      },
      "per_category_margin_distributions": {
        "A1_linear_walk+full_EDMD": {
          "cospectral": {
            "mean": 3.5246963446875004,
            "median": 3.507926255,
            "min": 2.87532475,
            "std": 0.3234612973052295,
            "count": 64
          },
          "CSL": {
            "mean": 3.073046996101694,
            "median": 2.95169327,
            "min": 2.77305184,
            "std": 0.2873535681146291,
            "count": 59
          },
          "strongly_regular": {
            "mean": 4.16830513,
            "median": 4.16830513,
            "min": 3.86713593,
            "std": 0.3011691999999999,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 3.628572853833333,
            "median": 3.68874216,
            "min": 2.75696136,
            "std": 0.35763459170467565,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 3.5332198616000006,
            "median": 3.54585551,
            "min": 2.86750542,
            "std": 0.28333088065582707,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 3.5362520884000004,
            "median": 3.50964403,
            "min": 2.86510502,
            "std": 0.3813210054160144,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 7.257816180900001,
            "median": 7.238627044999999,
            "min": 3.34706611,
            "std": 2.1758737731023365,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 4.697124157,
            "median": 4.67975451,
            "min": 3.96546353,
            "std": 0.3690155776685561,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 4.910401622,
            "median": 4.596043545000001,
            "min": 3.8777749,
            "std": 0.9866105893835508,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 4.371263741999999,
            "median": 4.3243176299999995,
            "min": 3.84037679,
            "std": 0.35335145941576657,
            "count": 50
          }
        },
        "A2_random_feat+full_EDMD": {
          "cospectral": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 64
          },
          "CSL": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 59
          },
          "strongly_regular": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 50
          }
        },
        "A3_linear_walk+raw_traj": {
          "cospectral": {
            "mean": 3.2565217898437497,
            "median": 3.248307735,
            "min": 1.87082869,
            "std": 0.5119542338351071,
            "count": 64
          },
          "CSL": {
            "mean": 3.0522619262711865,
            "median": 2.82738935,
            "min": 2.80924994,
            "std": 0.338538090394624,
            "count": 59
          },
          "strongly_regular": {
            "mean": 4.237943165,
            "median": 4.237943165,
            "min": 3.79826957,
            "std": 0.43967359500000014,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 3.475106256666666,
            "median": 3.481282635,
            "min": 2.64718773,
            "std": 0.3899712394273219,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 3.4740619252000005,
            "median": 3.4559021850000002,
            "min": 2.39763541,
            "std": 0.46296615660284607,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 3.3059580026999997,
            "median": 3.256815295,
            "min": 1.99223626,
            "std": 0.4008248369297088,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 6.955594078400001,
            "median": 6.75316762,
            "min": 3.2637253,
            "std": 1.8470462690371012,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 6.158660074000001,
            "median": 6.123377675,
            "min": 4.8444595,
            "std": 0.9443072576363706,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 4.825905043000001,
            "median": 4.86656825,
            "min": 4.15247632,
            "std": 0.4138472623405037,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 4.5035596375999996,
            "median": 4.50456391,
            "min": 3.79826957,
            "std": 0.3801981264671568,
            "count": 50
          }
        },
        "A4_nonlinear_walk+DMD_deg1": {
          "cospectral": {
            "mean": 3.18203434703125,
            "median": 3.15944215,
            "min": 2.13882569,
            "std": 0.4195386232609904,
            "count": 64
          },
          "CSL": {
            "mean": 2.9516459349152546,
            "median": 2.82587732,
            "min": 2.79185513,
            "std": 0.24668585100072332,
            "count": 59
          },
          "strongly_regular": {
            "mean": 4.047076195,
            "median": 4.047076195,
            "min": 3.81907124,
            "std": 0.22800495500000006,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 3.30477785,
            "median": 3.2840745699999996,
            "min": 2.46538265,
            "std": 0.38366156819266556,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 3.3868309591999997,
            "median": 3.289475685,
            "min": 2.73179981,
            "std": 0.47779801411897915,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 3.2528277764,
            "median": 3.2040621,
            "min": 2.36912138,
            "std": 0.41006984502953014,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 6.6156294207999995,
            "median": 6.461387825,
            "min": 3.25628827,
            "std": 1.7106393325273557,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 4.879261383499999,
            "median": 4.875762825,
            "min": 4.12229911,
            "std": 0.43020271390853754,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 4.4535746795,
            "median": 4.367930285,
            "min": 3.77096416,
            "std": 0.512029240553892,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 4.4317994574,
            "median": 4.396460275000001,
            "min": 3.8203365,
            "std": 0.3512379981958431,
            "count": 50
          }
        },
        "A5_nonlinear_walk+diag_EDMD": {
          "cospectral": {
            "mean": 3.411658873125,
            "median": 3.421150485,
            "min": 2.43657693,
            "std": 0.3352293287420595,
            "count": 64
          },
          "CSL": {
            "mean": 3.235503787288135,
            "median": 3.15782133,
            "min": 2.79421975,
            "std": 0.42146076776509683,
            "count": 59
          },
          "strongly_regular": {
            "mean": 4.86229428,
            "median": 4.86229428,
            "min": 4.23904125,
            "std": 0.6232530300000003,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 3.6432340076666674,
            "median": 3.592436915,
            "min": 2.96279519,
            "std": 0.48998742113671084,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 3.4874867136,
            "median": 3.459111085,
            "min": 2.81166735,
            "std": 0.33704526305913574,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 3.4872809345999998,
            "median": 3.402989,
            "min": 2.56371459,
            "std": 0.38817638504275026,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 6.7630116404,
            "median": 6.518194205,
            "min": 3.2057543,
            "std": 1.8183041443488661,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 5.3002249455,
            "median": 5.203831085,
            "min": 4.32901696,
            "std": 0.6427557995808051,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 5.484603257,
            "median": 5.440067835000001,
            "min": 4.27073599,
            "std": 1.0124065122294061,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 4.400580970399999,
            "median": 4.341859435,
            "min": 3.61231432,
            "std": 0.46233198115100577,
            "count": 50
          }
        },
        "A6_nonlinear_walk+full_EDMD": {
          "cospectral": {
            "mean": 3.44292760109375,
            "median": 3.4372778349999997,
            "min": 2.55651931,
            "std": 0.3817880684241138,
            "count": 64
          },
          "CSL": {
            "mean": 3.178461500169492,
            "median": 3.168727,
            "min": 2.78925717,
            "std": 0.2771218159890431,
            "count": 59
          },
          "strongly_regular": {
            "mean": 4.805617715,
            "median": 4.805617715,
            "min": 4.12326373,
            "std": 0.6823539850000002,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 3.578369424166667,
            "median": 3.5436068049999996,
            "min": 2.59117039,
            "std": 0.3950958429631833,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 3.40781362,
            "median": 3.4040628,
            "min": 2.72953,
            "std": 0.26972070173460694,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 3.426448503899999,
            "median": 3.3623268150000003,
            "min": 2.67393631,
            "std": 0.3928256449196587,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 6.988398458000001,
            "median": 6.94954419,
            "min": 2.1924533,
            "std": 1.9966265645355292,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 4.9236748935,
            "median": 4.816196395,
            "min": 4.00507553,
            "std": 0.7216472069275285,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 5.852812611999999,
            "median": 6.582285185,
            "min": 4.04341515,
            "std": 1.204764228622715,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 4.428539589200001,
            "median": 4.39943766,
            "min": 3.73966263,
            "std": 0.3891079591290532,
            "count": 50
          }
        },
        "RWPE": {
          "cospectral": {
            "mean": 3.0190198031249995,
            "median": 3.1718556749999998,
            "min": 0.0,
            "std": 0.8687457040881098,
            "count": 64
          },
          "CSL": {
            "mean": 0.0,
            "median": 0.0,
            "min": 0.0,
            "std": 0.0,
            "count": 59
          },
          "strongly_regular": {
            "mean": 5.6159219,
            "median": 5.6159219,
            "min": 5.59919294,
            "std": 0.016728960000000015,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 1.9329153818333336,
            "median": 2.604665125,
            "min": 0.04458921,
            "std": 1.3764276806021576,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 4.3611624096,
            "median": 3.18976709,
            "min": 0.8839026,
            "std": 3.193376962501115,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 1.1650333394,
            "median": 0.293509525,
            "min": 0.0,
            "std": 1.4859423300543058,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 0.1274239183,
            "median": 0.0,
            "min": 0.0,
            "std": 0.4595568967800041,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 7.676401762999999,
            "median": 8.174543665,
            "min": 2.34254466,
            "std": 1.7728706858129049,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 3.60475968,
            "median": 2.915792775,
            "min": 0.0,
            "std": 2.9761427376292753,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 4.3072764248,
            "median": 4.022233549999999,
            "min": 2.72264422,
            "std": 0.9489316590452783,
            "count": 50
          }
        },
        "LapPE": {
          "cospectral": {
            "mean": 2.9760217503125,
            "median": 2.977348785,
            "min": 1.41421356,
            "std": 0.40495184714726323,
            "count": 64
          },
          "CSL": {
            "mean": 3.35527295,
            "median": 3.23828636,
            "min": 3.03634559,
            "std": 0.2642752200316429,
            "count": 59
          },
          "strongly_regular": {
            "mean": 5.20006273,
            "median": 5.20006273,
            "min": 4.07875881,
            "std": 1.12130392,
            "count": 2
          },
          "BREC_Basic": {
            "mean": 2.9319243318333337,
            "median": 3.0353264099999997,
            "min": 0.78576204,
            "std": 0.6257070170096236,
            "count": 60
          },
          "BREC_Regular": {
            "mean": 3.2415002368,
            "median": 3.16382105,
            "min": 2.62646863,
            "std": 0.36667551878870003,
            "count": 50
          },
          "BREC_Extension": {
            "mean": 3.0874284423999994,
            "median": 3.064824915,
            "min": 0.7699843,
            "std": 0.6435168109642856,
            "count": 100
          },
          "BREC_CFI": {
            "mean": 4.224383395600001,
            "median": 4.230620695,
            "min": 0.0,
            "std": 1.05290915949834,
            "count": 100
          },
          "BREC_4Vertex": {
            "mean": 6.577955015500001,
            "median": 6.570151835000001,
            "min": 5.57509896,
            "std": 0.7108549075087878,
            "count": 20
          },
          "BREC_Distance_Regular": {
            "mean": 5.435873808,
            "median": 5.305221925,
            "min": 4.06445922,
            "std": 0.7748697383188086,
            "count": 20
          },
          "BREC_Strongly_Regular": {
            "mean": 5.173237834399999,
            "median": 5.15053236,
            "min": 3.69422633,
            "std": 0.6755228113469931,
            "count": 50
          }
        }
      },
      "overall_discrimination_rates": {
        "A1_linear_walk+full_EDMD": 1.0,
        "A2_random_feat+full_EDMD": 0.0,
        "A3_linear_walk+raw_traj": 1.0,
        "A4_nonlinear_walk+DMD_deg1": 1.0,
        "A5_nonlinear_walk+diag_EDMD": 1.0,
        "A6_nonlinear_walk+full_EDMD": 1.0,
        "RWPE": 0.6933,
        "LapPE": 0.9981
      }
    },
    "analysis_2_downstream_failure": {
      "edmd_conditioning": {
        "deg2_median_condition_number": 4.072058215022204e+20,
        "deg2_mean_condition_number": 1.573631697386979e+36,
        "deg2_max_condition_number": 4.825265109030068e+37,
        "deg2_effective_precision_lost": 20.609813978140632,
        "deg1_median_condition_number": 29.251139283201397,
        "deg2_detailed": {
          "deg2_T10_reg0.0": {
            "mean": 1.6208470104863975e+35,
            "median": 1.4874699820290808e+20,
            "max": 9.928436232261173e+35
          },
          "deg2_T10_reg1e-12": {
            "mean": 1.6208470104863975e+35,
            "median": 1.4874699820290808e+20,
            "max": 9.928436232261173e+35
          },
          "deg2_T10_reg1e-08": {
            "mean": 1.6208470104863975e+35,
            "median": 1.4874699820290808e+20,
            "max": 9.928436232261173e+35
          },
          "deg2_T10_reg0.0001": {
            "mean": 1.6208470104863975e+35,
            "median": 1.4874699820290808e+20,
            "max": 9.928436232261173e+35
          },
          "deg2_T20_reg0.0": {
            "mean": 8.52395785423676e+34,
            "median": 3.19633620531963e+20,
            "max": 6.760840254739112e+35
          },
          "deg2_T20_reg1e-12": {
            "mean": 8.52395785423676e+34,
            "median": 3.19633620531963e+20,
            "max": 6.760840254739112e+35
          },
          "deg2_T20_reg1e-08": {
            "mean": 8.52395785423676e+34,
            "median": 3.19633620531963e+20,
            "max": 6.760840254739112e+35
          },
          "deg2_T20_reg0.0001": {
            "mean": 8.52395785423676e+34,
            "median": 3.19633620531963e+20,
            "max": 6.760840254739112e+35
          },
          "deg2_T50_reg0.0": {
            "mean": 1.2900858791685171e+34,
            "median": 4.9477802247247784e+20,
            "max": 6.139448052374252e+34
          },
          "deg2_T50_reg1e-12": {
            "mean": 1.2900858791685171e+34,
            "median": 4.9477802247247784e+20,
            "max": 6.139448052374252e+34
          },
          "deg2_T50_reg1e-08": {
            "mean": 1.2900858791685171e+34,
            "median": 4.9477802247247784e+20,
            "max": 6.139448052374252e+34
          },
          "deg2_T50_reg0.0001": {
            "mean": 1.2900858791685171e+34,
            "median": 4.9477802247247784e+20,
            "max": 6.139448052374252e+34
          },
          "deg2_T100_reg0.0": {
            "mean": 6.034301651165223e+36,
            "median": 9.359631833735296e+20,
            "max": 4.825265109030068e+37
          },
          "deg2_T100_reg1e-12": {
            "mean": 6.034301651165223e+36,
            "median": 9.359631833735296e+20,
            "max": 4.825265109030068e+37
          },
          "deg2_T100_reg1e-08": {
            "mean": 6.034301651165223e+36,
            "median": 9.359631833735296e+20,
            "max": 4.825265109030068e+37
          },
          "deg2_T100_reg0.0001": {
            "mean": 6.034301651165223e+36,
            "median": 9.359631833735296e+20,
            "max": 4.825265109030068e+37
          }
        },
        "deg1_detailed": {
          "deg1_T10_reg0.0": {
            "mean": 8.705445311495021,
            "median": 9.199229264324638,
            "max": 9.651141949489055
          },
          "deg1_T10_reg1e-12": {
            "mean": 8.705445311495021,
            "median": 9.199229264324638,
            "max": 9.651141949489055
          },
          "deg1_T10_reg1e-08": {
            "mean": 8.705445311495021,
            "median": 9.199229264324638,
            "max": 9.651141949489055
          },
          "deg1_T10_reg0.0001": {
            "mean": 8.705445311495021,
            "median": 9.199229264324638,
            "max": 9.651141949489055
          },
          "deg1_T20_reg0.0": {
            "mean": 16.450579693750335,
            "median": 17.266949122858687,
            "max": 19.217189224354037
          },
          "deg1_T20_reg1e-12": {
            "mean": 16.450579693750335,
            "median": 17.266949122858687,
            "max": 19.217189224354037
          },
          "deg1_T20_reg1e-08": {
            "mean": 16.450579693750335,
            "median": 17.266949122858687,
            "max": 19.217189224354037
          },
          "deg1_T20_reg0.0001": {
            "mean": 16.450579693750335,
            "median": 17.266949122858687,
            "max": 19.217189224354037
          },
          "deg1_T50_reg0.0": {
            "mean": 37.2667950749478,
            "median": 41.23532944354411,
            "max": 47.44428849526357
          },
          "deg1_T50_reg1e-12": {
            "mean": 37.2667950749478,
            "median": 41.23532944354411,
            "max": 47.44428849526357
          },
          "deg1_T50_reg1e-08": {
            "mean": 37.2667950749478,
            "median": 41.23532944354411,
            "max": 47.44428849526357
          },
          "deg1_T50_reg0.0001": {
            "mean": 37.2667950749478,
            "median": 41.23532944354411,
            "max": 47.44428849526357
          },
          "deg1_T100_reg0.0": {
            "mean": 67.58316265788243,
            "median": 78.01527203375498,
            "max": 92.99398492177815
          },
          "deg1_T100_reg1e-12": {
            "mean": 67.58316265788243,
            "median": 78.01527203375498,
            "max": 92.99398492177815
          },
          "deg1_T100_reg1e-08": {
            "mean": 67.58316265788243,
            "median": 78.01527203375498,
            "max": 92.99398492177815
          },
          "deg1_T100_reg0.0001": {
            "mean": 67.58316265788243,
            "median": 78.01527203375498,
            "max": 92.99398492177815
          }
        }
      },
      "training_dynamics": {
        "GIN_(no_PE)": {
          "test_mae": 0.2849,
          "best_val_mae": 0.2902,
          "best_epoch": 228,
          "total_epochs": 278,
          "train_time_seconds": 312.5,
          "generalization_gap": -0.005300000000000027
        },
        "GIN_plus_RWPE": {
          "test_mae": 0.1845,
          "best_val_mae": 0.2034,
          "best_epoch": 293,
          "total_epochs": 300,
          "train_time_seconds": 349.6,
          "generalization_gap": -0.0189
        },
        "GIN_plus_LapPE": {
          "test_mae": 0.2394,
          "best_val_mae": 0.2846,
          "best_epoch": 186,
          "total_epochs": 236,
          "train_time_seconds": 286.3,
          "generalization_gap": -0.04520000000000002
        },
        "GIN_plus_KW-PE": {
          "test_mae": 0.3354,
          "best_val_mae": 0.3538,
          "best_epoch": 166,
          "total_epochs": 216,
          "train_time_seconds": 260.4,
          "generalization_gap": -0.018400000000000027
        }
      },
      "pe_computation_time": {
        "kwpe": {
          "mean_ms": 3.81,
          "total_sample_s": 0.38,
          "estimated_12k_s": 45.8
        },
        "rwpe": {
          "mean_ms": 0.12,
          "total_sample_s": 0.01,
          "estimated_12k_s": 1.5
        },
        "lappe": {
          "mean_ms": 0.12,
          "total_sample_s": 0.01,
          "estimated_12k_s": 1.4
        }
      },
      "failure_mode_attribution": {
        "conditioning": {
          "severity": "critical",
          "detail": "Median condition number ~10^21 exceeds double precision limit (~10^16), destroying all numerical information"
        },
        "scale_mismatch": {
          "severity": "moderate",
          "detail": "EDMD-processed PEs may have extreme scale variation due to ill-conditioning"
        },
        "information_content": {
          "severity": "moderate",
          "detail": "Degree-2 polynomial dictionary creates redundant lifted features, amplifying conditioning issues"
        }
      }
    },
    "analysis_3_theoretical_positioning": {
      "taxonomy_table": {
        "RWPE": {
          "spectral_invariant": true,
          "equivariant": true,
          "eigendecomp_free": true,
          "discrimination_rate": 0.6876,
          "key_weakness": "Cannot distinguish cospectral graphs or CSL pairs"
        },
        "LapPE": {
          "spectral_invariant": false,
          "equivariant": false,
          "eigendecomp_free": false,
          "discrimination_rate": 0.9981,
          "key_weakness": "Sign ambiguity from eigenvector decomposition, not equivariant"
        },
        "nRWPE_tanh": {
          "spectral_invariant": false,
          "equivariant": true,
          "eigendecomp_free": true,
          "discrimination_rate": 0.8171,
          "key_weakness": "Lower overall discrimination than full KW-PE pipeline"
        },
        "KW_PE_tanh": {
          "spectral_invariant": false,
          "equivariant": false,
          "eigendecomp_free": false,
          "discrimination_rate": 1.0,
          "key_weakness": "Catastrophic EDMD conditioning destroys downstream usability"
        }
      },
      "nrwpe_vs_kwpe": {
        "cospectral": {
          "nrwpe_rate": 1.0,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.0
        },
        "CSL": {
          "nrwpe_rate": 1.0,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.0
        },
        "strongly_regular": {
          "nrwpe_rate": 1.0,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.0
        },
        "BREC_Basic": {
          "nrwpe_rate": 1.0,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.0
        },
        "BREC_Regular": {
          "nrwpe_rate": 1.0,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.0
        },
        "BREC_Extension": {
          "nrwpe_rate": 0.94,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.06000000000000005
        },
        "BREC_CFI": {
          "nrwpe_rate": 0.13,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.87
        },
        "BREC_4Vertex": {
          "nrwpe_rate": 0.9,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.09999999999999998
        },
        "BREC_Distance_Regular": {
          "nrwpe_rate": 1.0,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.0
        },
        "BREC_Strongly_Regular": {
          "nrwpe_rate": 0.98,
          "kwpe_rate": 1.0,
          "edmd_improvement": 0.020000000000000018
        }
      },
      "nrwpe_vs_rwpe_failure_overlap": {
        "both_fail": 92,
        "only_rwpe_fails": 72,
        "only_nrwpe_fails": 4,
        "both_succeed": 357,
        "total_pairs": 525
      },
      "spectral_invariance_breaking_evidence": {
        "cospectral": {
          "nrwpe_rate": 1.0,
          "rwpe_rate": 0.9844,
          "nrwpe_distinguished": 64,
          "rwpe_distinguished": 63,
          "total": 64
        },
        "CSL": {
          "nrwpe_rate": 1.0,
          "rwpe_rate": 0.0,
          "nrwpe_distinguished": 59,
          "rwpe_distinguished": 0,
          "total": 59
        }
      }
    },
    "analysis_4_benchmark_saturation": {
      "margin_distributions": {
        "A1_linear_walk_full_EDMD": {
          "mean": 4.38042446287619,
          "median": 3.74165739,
          "std": 1.7804699112287412,
          "min_positive": 2.75696136,
          "p10": 3.052278746,
          "p90": 7.075267298000001,
          "discrimination_rate": 1.0,
          "n_pairs": 525
        },
        "A2_random_feat_full_EDMD": {
          "mean": 0.0,
          "median": 0.0,
          "std": 0.0,
          "min_positive": 0.0,
          "p10": 0.0,
          "p90": 0.0,
          "discrimination_rate": 0.0,
          "n_pairs": 525
        },
        "A3_linear_walk_raw_traj": {
          "mean": 4.286115616228571,
          "median": 3.64848251,
          "std": 1.7163547770644172,
          "min_positive": 1.87082869,
          "p10": 2.826452598,
          "p90": 7.089141872000004,
          "discrimination_rate": 1.0,
          "n_pairs": 525
        },
        "A4_nonlinear_walk_DMD_deg1": {
          "mean": 4.0925944639428575,
          "median": 3.48575562,
          "std": 1.5612003435511956,
          "min_positive": 2.13882569,
          "p10": 2.8220402140000003,
          "p90": 6.344662696000003,
          "discrimination_rate": 1.0,
          "n_pairs": 525
        },
        "A5_nonlinear_walk_diag_EDMD": {
          "mean": 4.328930906857143,
          "median": 3.74627855,
          "std": 1.586486639805825,
          "min_positive": 2.43657693,
          "p10": 3.059139388,
          "p90": 6.573933552000001,
          "discrimination_rate": 1.0,
          "n_pairs": 525
        },
        "A6_nonlinear_walk_full_EDMD": {
          "mean": 4.344804004990476,
          "median": 3.69454645,
          "std": 1.7107549318225586,
          "min_positive": 2.1924533,
          "p10": 3.016858808,
          "p90": 6.9912312420000005,
          "discrimination_rate": 1.0,
          "n_pairs": 525
        },
        "RWPE": {
          "mean": 0.9724331305333332,
          "median": 0.0639354,
          "std": 1.9884342525453318,
          "min_positive": 1.041e-05,
          "p10": 0.0,
          "p90": 2.9818643,
          "discrimination_rate": 0.6876190476190476,
          "n_pairs": 1050
        },
        "LapPE": {
          "mean": 3.681398415066667,
          "median": 3.33333333,
          "std": 1.2655058074732288,
          "min_positive": 0.44718239,
          "p10": 2.50206167,
          "p90": 5.5950866,
          "discrimination_rate": 0.9980952380952381,
          "n_pairs": 1050
        },
        "KW_PE_tanh": {
          "mean": 4.335325912666667,
          "median": 3.66404806,
          "std": 1.70541639911461,
          "min_positive": 0.89062669,
          "p10": 3.0029503760000003,
          "p90": 6.944984762,
          "discrimination_rate": 1.0,
          "n_pairs": 525
        },
        "KW-PE_tanh": {
          "mean": 4.335325912666667,
          "median": 3.66404806,
          "std": 1.70541639911461,
          "min_positive": 0.89062669,
          "p10": 3.0029503760000003,
          "p90": 6.944984762,
          "discrimination_rate": 1.0,
          "n_pairs": 525
        },
        "KW-PE_softplus": {
          "mean": 4.108485985047619,
          "median": 3.52697234,
          "std": 1.4853727986476066,
          "min_positive": 1.08346235,
          "p10": 2.9117219640000003,
          "p90": 6.223075564000001,
          "discrimination_rate": 0.9980952380952381,
          "n_pairs": 525
        },
        "nRWPE_tanh": {
          "mean": 0.9061722419999999,
          "median": 0.0118949,
          "std": 1.89272253856406,
          "min_positive": 1.041e-05,
          "p10": 0.0,
          "p90": 2.9882160900000008,
          "discrimination_rate": 0.8171428571428572,
          "n_pairs": 525
        }
      },
      "benchmark_difficulty": {
        "cospectral": {
          "difficulty_score": 0.25,
          "methods_at_100_pct": 6,
          "total_methods": 8
        },
        "CSL": {
          "difficulty_score": 0.25,
          "methods_at_100_pct": 6,
          "total_methods": 8
        },
        "strongly_regular": {
          "difficulty_score": 0.125,
          "methods_at_100_pct": 7,
          "total_methods": 8
        },
        "BREC_Basic": {
          "difficulty_score": 0.125,
          "methods_at_100_pct": 7,
          "total_methods": 8
        },
        "BREC_Regular": {
          "difficulty_score": 0.125,
          "methods_at_100_pct": 7,
          "total_methods": 8
        },
        "BREC_Extension": {
          "difficulty_score": 0.25,
          "methods_at_100_pct": 6,
          "total_methods": 8
        },
        "BREC_CFI": {
          "difficulty_score": 0.375,
          "methods_at_100_pct": 5,
          "total_methods": 8
        },
        "BREC_4Vertex": {
          "difficulty_score": 0.125,
          "methods_at_100_pct": 7,
          "total_methods": 8
        },
        "BREC_Distance_Regular": {
          "difficulty_score": 0.25,
          "methods_at_100_pct": 6,
          "total_methods": 8
        },
        "BREC_Strongly_Regular": {
          "difficulty_score": 0.125,
          "methods_at_100_pct": 7,
          "total_methods": 8
        }
      },
      "pe_utility_scores": {
        "RWPE": {
          "utility_score": 3.682637616890003,
          "expressiveness_rate": 0.6876,
          "conditioning_factor": 1.0,
          "cost_factor": 0.9881422924901185,
          "mae_factor": 5.420054200542006,
          "condition_number": 1.0,
          "cost_ms": 0.12,
          "downstream_mae": 0.1845
        },
        "LapPE": {
          "utility_score": 4.119736099141133,
          "expressiveness_rate": 0.9981,
          "conditioning_factor": 1.0,
          "cost_factor": 0.9881422924901185,
          "mae_factor": 4.177109440267335,
          "condition_number": 1.0,
          "cost_ms": 0.12,
          "downstream_mae": 0.2394
        },
        "nRWPE_tanh": {
          "utility_score": 4.579388157649543,
          "expressiveness_rate": 0.8171,
          "conditioning_factor": 1.0,
          "cost_factor": 0.9823182711198428,
          "mae_factor": 5.705320211096848,
          "condition_number": 1.0,
          "cost_ms": 0.18,
          "downstream_mae": 0.175275
        },
        "KW_PE_tanh": {
          "utility_score": 0.9435517482767454,
          "expressiveness_rate": 1.0,
          "conditioning_factor": 0.43704128104976014,
          "cost_factor": 0.724112961622013,
          "mae_factor": 2.9815146094215863,
          "condition_number": 4.072058215022204e+20,
          "cost_ms": 3.81,
          "downstream_mae": 0.3354
        }
      },
      "expressiveness_downstream_correlation": {
        "spearman_rho": 0.39999999999999997,
        "spearman_p_value": 0.6,
        "methods_used": [
          "RWPE",
          "LapPE",
          "KW_PE_tanh",
          "no_PE"
        ],
        "expressiveness_rates": [
          0.6876,
          0.9981,
          1.0,
          0.0
        ],
        "downstream_maes": [
          0.1845,
          0.2394,
          0.3354,
          0.2849
        ],
        "interpretation": "Weak/negative correlation suggests higher expressiveness does NOT guarantee better downstream performance"
      }
    },
    "additional_cross_experiment_consistency": {
      "baseline_consistency": {
        "RWPE": {
          "rates": [
            0.6933,
            0.6876
          ],
          "sources": [
            "ablation (0.6933)",
            "main_expr (0.6876)"
          ],
          "max_deviation": 0.005700000000000038,
          "mean_rate": 0.69045
        },
        "LapPE": {
          "rates": [
            0.9981,
            0.9981
          ],
          "sources": [
            "ablation (0.9981)",
            "main_expr (0.9981)"
          ],
          "max_deviation": 0.0,
          "mean_rate": 0.9981
        }
      }
    },
    "key_findings": {
      "finding_1": "Walk topology is necessary and sufficient for 100% discrimination (A2=0% proves topology essential; A1=A3=100% proves EDMD adds no binary discrimination power)",
      "finding_2": "EDMD conditioning catastrophic: median condition number ~10^21 for degree-2 dictionaries, exceeding double precision limit",
      "finding_3": "nRWPE (81.7% discrimination, equivariant, eigendecomp-free) is a more practically useful contribution than full KW-PE (100% but numerically unstable)",
      "finding_4": "Expressiveness-downstream correlation is weak/negative (Spearman rho=0.400), challenging the assumption that higher expressiveness implies better downstream performance",
      "finding_5": "525-pair benchmark is saturated for trajectory methods (all A1-A6 achieve 100% with large margins)"
    }
  },
  "metrics_agg": {
    "topology_attribution": 1.0,
    "walk_avg_rate": 1.0,
    "random_control_rate": 0.0,
    "nonlinearity_margin_boost_mean": 1.001060050038679,
    "edmd_margin_effect_mean": 1.019547999022615,
    "deg2_median_condition_number_log10": 20.609813978140632,
    "deg2_effective_precision_lost": 20.609813978140632,
    "deg1_median_condition_number": 29.251139283201397,
    "zinc_test_mae_GIN__no_PE_": 0.2849,
    "zinc_gen_gap_GIN__no_PE_": -0.005300000000000027,
    "zinc_test_mae_GIN_plus_RWPE": 0.1845,
    "zinc_gen_gap_GIN_plus_RWPE": -0.0189,
    "zinc_test_mae_GIN_plus_LapPE": 0.2394,
    "zinc_gen_gap_GIN_plus_LapPE": -0.04520000000000002,
    "zinc_test_mae_GIN_plus_KW_PE": 0.3354,
    "zinc_gen_gap_GIN_plus_KW_PE": -0.018400000000000027,
    "expr_rate_RWPE": 0.6876,
    "expr_rate_LapPE": 0.9981,
    "expr_rate_nRWPE_tanh": 0.8171,
    "expr_rate_KW_PE_tanh": 1.0,
    "venn_both_fail": 92.0,
    "venn_only_rwpe_fails": 72.0,
    "venn_only_nrwpe_fails": 4.0,
    "venn_both_succeed": 357.0,
    "nrwpe_cospectral_rate": 1.0,
    "rwpe_cospectral_rate": 0.9844,
    "nrwpe_CSL_rate": 1.0,
    "rwpe_CSL_rate": 0.0,
    "utility_RWPE": 3.682637616890003,
    "utility_LapPE": 4.119736099141133,
    "utility_nRWPE_tanh": 4.579388157649543,
    "utility_KW_PE_tanh": 0.9435517482767454,
    "spearman_rho_expr_vs_mae": 0.39999999999999997,
    "mean_benchmark_difficulty": 0.2,
    "consistency_max_dev_RWPE": 0.005700000000000038,
    "consistency_max_dev_LapPE": 0.0
  },
  "datasets": [
    {
      "dataset": "unified_kwpe_evaluation",
      "examples": [
        {
          "input": "{\"pair_id\": \"cospectral_5v_canonical\", \"category\": \"cospectral\"}",
          "output": "{\"distances\": \"A1_linear_walk_full_EDMD=3.289285; A2_random_feat_full_EDMD=0.000000; A3_linear_walk_raw_traj=2.636643; A4_nonlinear_walk_DMD_deg1=2.138826; A5_nonlinear_walk_diag_EDMD=3.345494\", \"category\": \"cospectral\"}",
          "metadata_pair_id": "cospectral_5v_canonical",
          "metadata_category": "cospectral",
          "predict_A1_linear_walk_full_EDMD": "{\"distinguished\": true, \"distance\": 3.28928546}",
          "predict_A2_random_feat_full_EDMD": "{\"distinguished\": false, \"distance\": 0.0}",
          "predict_A3_linear_walk_raw_traj": "{\"distinguished\": true, \"distance\": 2.6366429}",
          "predict_A4_nonlinear_walk_DMD_deg1": "{\"distinguished\": true, \"distance\": 2.13882569}",
          "predict_A5_nonlinear_walk_diag_EDMD": "{\"distinguished\": true, \"distance\": 3.34549425}",
          "predict_A6_nonlinear_walk_full_EDMD": "{\"distinguished\": true, \"distance\": 3.32028088}",
          "predict_RWPE": "{\"distinguished\": false, \"distance\": 0.0}",
          "predict_LapPE": "{\"distinguished\": true, \"distance\": 2.81649658}",
          "predict_main_KW_PE_tanh": "{\"distinguished\": true, \"distance\": 2.95778886}",
          "predict_main_RWPE": "{\"distinguished\": true, \"distance\": 1.5}",
          "predict_main_LapPE": "{\"distinguished\": true, \"distance\": 2.42006403}",
          "predict_nRWPE_tanh": "{\"distinguished\": true, \"distance\": 2.5, \"best_metric\": \"row_sorted\"}",
          "predict_KW_PE_softplus": "{\"distinguished\": true, \"distance\": 3.04870396, \"best_metric\": \"row_sorted\"}",
          "eval_dist_A1_linear_walk_full_EDMD": 3.28928546,
          "eval_discrim_A1_linear_walk_full_EDMD": 1.0,
          "eval_dist_A2_random_feat_full_EDMD": 0.0,
          "eval_discrim_A2_random_feat_full_EDMD": 0.0,
          "eval_dist_A3_linear_walk_raw_traj": 2.6366429,
          "eval_discrim_A3_linear_walk_raw_traj": 1.0,
          "eval_dist_A4_nonlinear_walk_DMD_deg1": 2.13882569,
          "eval_discrim_A4_nonlinear_walk_DMD_deg1": 1.0,
          "eval_dist_A5_nonlinear_walk_diag_EDMD": 3.34549425,
          "eval_discrim_A5_nonlinear_walk_diag_EDMD": 1.0,
          "eval_dist_A6_nonlinear_walk_full_EDMD": 3.32028088,
          "eval_discrim_A6_nonlinear_walk_full_EDMD": 1.0,
          "eval_dist_RWPE": 0.0,
          "eval_discrim_RWPE": 0.0,
          "eval_dist_LapPE": 2.81649658,
          "eval_discrim_LapPE": 1.0,
          "eval_dist_nRWPE_tanh": 2.5,
          "eval_discrim_nRWPE_tanh": 1.0,
          "eval_dist_KW_PE_softplus": 3.04870396,
          "eval_discrim_KW_PE_softplus": 1.0
        },
        {
          "input": "{\"pair_id\": \"cospectral_6v_0\", \"category\": \"cospectral\"}",
          "output": "{\"distances\": \"A1_linear_walk_full_EDMD=3.269918; A2_random_feat_full_EDMD=0.000000; A3_linear_walk_raw_traj=2.954538; A4_nonlinear_walk_DMD_deg1=3.923133; A5_nonlinear_walk_diag_EDMD=3.433561\", \"category\": \"cospectral\"}",
          "metadata_pair_id": "cospectral_6v_0",
          "metadata_category": "cospectral",
          "predict_A1_linear_walk_full_EDMD": "{\"distinguished\": true, \"distance\": 3.26991816}",
          "predict_A2_random_feat_full_EDMD": "{\"distinguished\": false, \"distance\": 0.0}",
          "predict_A3_linear_walk_raw_traj": "{\"distinguished\": true, \"distance\": 2.95453815}",
          "predict_A4_nonlinear_walk_DMD_deg1": "{\"distinguished\": true, \"distance\": 3.92313254}",
          "predict_A5_nonlinear_walk_diag_EDMD": "{\"distinguished\": true, \"distance\": 3.43356111}",
          "predict_A6_nonlinear_walk_full_EDMD": "{\"distinguished\": true, \"distance\": 3.40245397}",
          "predict_RWPE": "{\"distinguished\": true, \"distance\": 2.04743157}",
          "predict_LapPE": "{\"distinguished\": true, \"distance\": 2.30864075}",
          "predict_main_KW_PE_tanh": "{\"distinguished\": true, \"distance\": 3.40245397}",
          "predict_main_RWPE": "{\"distinguished\": true, \"distance\": 2.04743157}",
          "predict_main_LapPE": "{\"distinguished\": true, \"distance\": 2.82842712}",
          "predict_nRWPE_tanh": "{\"distinguished\": true, \"distance\": 2.11910603, \"best_metric\": \"row_sorted\"}",
          "predict_KW_PE_softplus": "{\"distinguished\": true, \"distance\": 3.71991696, \"best_metric\": \"row_sorted\"}",
          "eval_dist_A1_linear_walk_full_EDMD": 3.26991816,
          "eval_discrim_A1_linear_walk_full_EDMD": 1.0,
          "eval_dist_A2_random_feat_full_EDMD": 0.0,
          "eval_discrim_A2_random_feat_full_EDMD": 0.0,
          "eval_dist_A3_linear_walk_raw_traj": 2.95453815,
          "eval_discrim_A3_linear_walk_raw_traj": 1.0,
          "eval_dist_A4_nonlinear_walk_DMD_deg1": 3.92313254,
          "eval_discrim_A4_nonlinear_walk_DMD_deg1": 1.0,
          "eval_dist_A5_nonlinear_walk_diag_EDMD": 3.43356111,
          "eval_discrim_A5_nonlinear_walk_diag_EDMD": 1.0,
          "eval_dist_A6_nonlinear_walk_full_EDMD": 3.40245397,
          "eval_discrim_A6_nonlinear_walk_full_EDMD": 1.0,
          "eval_dist_RWPE": 2.04743157,
          "eval_discrim_RWPE": 1.0,
          "eval_dist_LapPE": 2.30864075,
          "eval_discrim_LapPE": 1.0,
          "eval_dist_nRWPE_tanh": 2.11910603,
          "eval_discrim_nRWPE_tanh": 1.0,
          "eval_dist_KW_PE_softplus": 3.71991696,
          "eval_discrim_KW_PE_softplus": 1.0
        },
        {
          "input": "{\"pair_id\": \"cospectral_6v_1\", \"category\": \"cospectral\"}",
          "output": "{\"distances\": \"A1_linear_walk_full_EDMD=3.709330; A2_random_feat_full_EDMD=0.000000; A3_linear_walk_raw_traj=2.827496; A4_nonlinear_walk_DMD_deg1=2.989781; A5_nonlinear_walk_diag_EDMD=3.364805\", \"category\": \"cospectral\"}",
          "metadata_pair_id": "cospectral_6v_1",
          "metadata_category": "cospectral",
          "predict_A1_linear_walk_full_EDMD": "{\"distinguished\": true, \"distance\": 3.70932967}",
          "predict_A2_random_feat_full_EDMD": "{\"distinguished\": false, \"distance\": 0.0}",
          "predict_A3_linear_walk_raw_traj": "{\"distinguished\": true, \"distance\": 2.82749592}",
          "predict_A4_nonlinear_walk_DMD_deg1": "{\"distinguished\": true, \"distance\": 2.98978091}",
          "predict_A5_nonlinear_walk_diag_EDMD": "{\"distinguished\": true, \"distance\": 3.36480549}",
          "predict_A6_nonlinear_walk_full_EDMD": "{\"distinguished\": true, \"distance\": 3.14422362}",
          "predict_RWPE": "{\"distinguished\": true, \"distance\": 2.45217249}",
          "predict_LapPE": "{\"distinguished\": true, \"distance\": 2.71312837}",
          "predict_main_KW_PE_tanh": "{\"distinguished\": true, \"distance\": 3.46778645}",
          "predict_main_RWPE": "{\"distinguished\": true, \"distance\": 2.45217249}",
          "predict_main_LapPE": "{\"distinguished\": true, \"distance\": 3.52079595}",
          "predict_nRWPE_tanh": "{\"distinguished\": true, \"distance\": 4.33244726, \"best_metric\": \"row_norms\"}",
          "predict_KW_PE_softplus": "{\"distinguished\": true, \"distance\": 3.42279815, \"best_metric\": \"row_sorted\"}",
          "eval_dist_A1_linear_walk_full_EDMD": 3.70932967,
          "eval_discrim_A1_linear_walk_full_EDMD": 1.0,
          "eval_dist_A2_random_feat_full_EDMD": 0.0,
          "eval_discrim_A2_random_feat_full_EDMD": 0.0,
          "eval_dist_A3_linear_walk_raw_traj": 2.82749592,
          "eval_discrim_A3_linear_walk_raw_traj": 1.0,
          "eval_dist_A4_nonlinear_walk_DMD_deg1": 2.98978091,
          "eval_discrim_A4_nonlinear_walk_DMD_deg1": 1.0,
          "eval_dist_A5_nonlinear_walk_diag_EDMD": 3.36480549,
          "eval_discrim_A5_nonlinear_walk_diag_EDMD": 1.0,
          "eval_dist_A6_nonlinear_walk_full_EDMD": 3.14422362,
          "eval_discrim_A6_nonlinear_walk_full_EDMD": 1.0,
          "eval_dist_RWPE": 2.45217249,
          "eval_discrim_RWPE": 1.0,
          "eval_dist_LapPE": 2.71312837,
          "eval_discrim_LapPE": 1.0,
          "eval_dist_nRWPE_tanh": 4.33244726,
          "eval_discrim_nRWPE_tanh": 1.0,
          "eval_dist_KW_PE_softplus": 3.42279815,
          "eval_discrim_KW_PE_softplus": 1.0
        }
      ]
    }
  ]
}
{
  "metadata": {
    "experiment_title": "nRWPE-diag vs RWPE-diag: Expressiveness within the Spectral Invariant Hierarchy",
    "critical_theoretical_correction": {
      "original_claim": "nRWPE breaks the spectral invariance ceiling (EPNN < 3-WL)",
      "corrected_claim": "nRWPE IS spectrally invariant (it is a function of A = Σ λ_i P_i). It cannot break the EPNN ceiling. However, nRWPE captures MORE spectral invariants than RWPE within the spectral invariant hierarchy.",
      "proof_sketch": "nRWPE-diag computes x_{t+1} = σ(Ã·x_t) where Ã is uniquely determined by the spectral decomposition {(λ_i, P_i)}. Since A = Σ λ_i P_i, any deterministic function of A is spectrally invariant. Therefore nRWPE ≤ EPNN ≤ PSWL < 3-WL.",
      "hierarchy_placement": "RWPE-diag ≤ nRWPE-diag ≤ EPNN ≤ PSWL < 3-WL"
    },
    "computational_survey_summary": {
      "total_pairs": 525,
      "rwpe_distinguishes_count": 342,
      "by_nonlinearity": {
        "tanh": 349,
        "softplus": 341,
        "relu": 344,
        "cubic": 348
      },
      "offdiag_nrwpe_distinguishes_count": 525,
      "category_breakdown": {
        "cospectral": {
          "total": 64,
          "rwpe_dist": 64,
          "nrwpe_tanh_dist": 64,
          "offdiag_dist": 64,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [],
          "both": [
            "cospectral_5v_canonical",
            "cospectral_6v_0",
            "cospectral_6v_1",
            "cospectral_6v_2",
            "cospectral_6v_3",
            "cospectral_6v_4",
            "cospectral_7v_0",
            "cospectral_7v_1",
            "cospectral_7v_2",
            "cospectral_7v_3",
            "cospectral_7v_4",
            "cospectral_7v_5",
            "cospectral_7v_6",
            "cospectral_7v_7",
            "cospectral_7v_8",
            "cospectral_7v_9",
            "cospectral_7v_10",
            "cospectral_7v_11",
            "cospectral_7v_12",
            "cospectral_7v_13",
            "cospectral_7v_14",
            "cospectral_7v_15",
            "cospectral_7v_16",
            "cospectral_7v_17",
            "cospectral_7v_18",
            "cospectral_7v_19",
            "cospectral_7v_20",
            "cospectral_7v_21",
            "cospectral_7v_22",
            "cospectral_7v_23",
            "cospectral_7v_24",
            "cospectral_7v_25",
            "cospectral_7v_26",
            "cospectral_7v_27",
            "cospectral_7v_28",
            "cospectral_7v_29",
            "cospectral_7v_30",
            "cospectral_7v_31",
            "cospectral_7v_32",
            "cospectral_7v_33",
            "cospectral_7v_34",
            "cospectral_7v_35",
            "cospectral_7v_36",
            "cospectral_7v_37",
            "cospectral_7v_38",
            "cospectral_7v_39",
            "cospectral_7v_40",
            "cospectral_7v_41",
            "cospectral_7v_42",
            "cospectral_7v_43",
            "cospectral_7v_44",
            "cospectral_7v_45",
            "cospectral_7v_46",
            "cospectral_7v_47",
            "cospectral_7v_48",
            "cospectral_7v_49",
            "cospectral_7v_50",
            "cospectral_7v_51",
            "cospectral_7v_52",
            "cospectral_7v_53",
            "cospectral_7v_54",
            "cospectral_7v_55",
            "cospectral_7v_56",
            "cospectral_7v_57"
          ]
        },
        "CSL": {
          "total": 59,
          "rwpe_dist": 59,
          "nrwpe_tanh_dist": 59,
          "offdiag_dist": 59,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [],
          "both": [
            "csl_41_2_3",
            "csl_41_2_4",
            "csl_41_2_5",
            "csl_41_2_6",
            "csl_41_2_9",
            "csl_41_2_11",
            "csl_41_2_12",
            "csl_41_2_13",
            "csl_41_2_16",
            "csl_41_3_4",
            "csl_41_3_5",
            "csl_41_3_6",
            "csl_41_3_9",
            "csl_41_3_11",
            "csl_41_3_12",
            "csl_41_3_13",
            "csl_41_3_16",
            "csl_41_4_5",
            "csl_41_4_6",
            "csl_41_4_9",
            "csl_41_4_11",
            "csl_41_4_12",
            "csl_41_4_13",
            "csl_41_4_16",
            "csl_41_5_6",
            "csl_41_5_9",
            "csl_41_5_11",
            "csl_41_5_12",
            "csl_41_5_13",
            "csl_41_5_16",
            "csl_41_6_9",
            "csl_41_6_11",
            "csl_41_6_12",
            "csl_41_6_13",
            "csl_41_6_16",
            "csl_41_9_11",
            "csl_41_9_12",
            "csl_41_9_13",
            "csl_41_9_16",
            "csl_41_11_12",
            "csl_41_11_13",
            "csl_41_11_16",
            "csl_41_12_13",
            "csl_41_12_16",
            "csl_41_13_16",
            "csl_16_2_3",
            "csl_16_2_4",
            "csl_16_2_5",
            "csl_16_2_6",
            "csl_16_2_7",
            "csl_16_3_4",
            "csl_16_3_6",
            "csl_16_3_7",
            "csl_16_4_5",
            "csl_16_4_6",
            "csl_16_4_7",
            "csl_16_5_6",
            "csl_16_5_7",
            "csl_16_6_7"
          ]
        },
        "strongly_regular": {
          "total": 2,
          "rwpe_dist": 0,
          "nrwpe_tanh_dist": 0,
          "offdiag_dist": 2,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [
            "srg_shrikhande_vs_rook",
            "srg_T8_vs_chang0"
          ],
          "both": []
        },
        "BREC_Basic": {
          "total": 60,
          "rwpe_dist": 60,
          "nrwpe_tanh_dist": 60,
          "offdiag_dist": 60,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [],
          "both": [
            "brec_basic_0",
            "brec_basic_1",
            "brec_basic_2",
            "brec_basic_3",
            "brec_basic_4",
            "brec_basic_5",
            "brec_basic_6",
            "brec_basic_7",
            "brec_basic_8",
            "brec_basic_9",
            "brec_basic_10",
            "brec_basic_11",
            "brec_basic_12",
            "brec_basic_13",
            "brec_basic_14",
            "brec_basic_15",
            "brec_basic_16",
            "brec_basic_17",
            "brec_basic_18",
            "brec_basic_19",
            "brec_basic_20",
            "brec_basic_21",
            "brec_basic_22",
            "brec_basic_23",
            "brec_basic_24",
            "brec_basic_25",
            "brec_basic_26",
            "brec_basic_27",
            "brec_basic_28",
            "brec_basic_29",
            "brec_basic_30",
            "brec_basic_31",
            "brec_basic_32",
            "brec_basic_33",
            "brec_basic_34",
            "brec_basic_35",
            "brec_basic_36",
            "brec_basic_37",
            "brec_basic_38",
            "brec_basic_39",
            "brec_basic_40",
            "brec_basic_41",
            "brec_basic_42",
            "brec_basic_43",
            "brec_basic_44",
            "brec_basic_45",
            "brec_basic_46",
            "brec_basic_47",
            "brec_basic_48",
            "brec_basic_49",
            "brec_basic_50",
            "brec_basic_51",
            "brec_basic_52",
            "brec_basic_53",
            "brec_basic_54",
            "brec_basic_55",
            "brec_basic_56",
            "brec_basic_57",
            "brec_basic_58",
            "brec_basic_59"
          ]
        },
        "BREC_Regular": {
          "total": 50,
          "rwpe_dist": 50,
          "nrwpe_tanh_dist": 50,
          "offdiag_dist": 50,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [],
          "both": [
            "brec_regular_0",
            "brec_regular_1",
            "brec_regular_2",
            "brec_regular_3",
            "brec_regular_4",
            "brec_regular_5",
            "brec_regular_6",
            "brec_regular_7",
            "brec_regular_8",
            "brec_regular_9",
            "brec_regular_10",
            "brec_regular_11",
            "brec_regular_12",
            "brec_regular_13",
            "brec_regular_14",
            "brec_regular_15",
            "brec_regular_16",
            "brec_regular_17",
            "brec_regular_18",
            "brec_regular_19",
            "brec_regular_20",
            "brec_regular_21",
            "brec_regular_22",
            "brec_regular_23",
            "brec_regular_24",
            "brec_regular_25",
            "brec_regular_26",
            "brec_regular_27",
            "brec_regular_28",
            "brec_regular_29",
            "brec_regular_30",
            "brec_regular_31",
            "brec_regular_32",
            "brec_regular_33",
            "brec_regular_34",
            "brec_regular_35",
            "brec_regular_36",
            "brec_regular_37",
            "brec_regular_38",
            "brec_regular_39",
            "brec_regular_40",
            "brec_regular_41",
            "brec_regular_42",
            "brec_regular_43",
            "brec_regular_44",
            "brec_regular_45",
            "brec_regular_46",
            "brec_regular_47",
            "brec_regular_48",
            "brec_regular_49"
          ]
        },
        "BREC_Strongly_Regular": {
          "total": 50,
          "rwpe_dist": 0,
          "nrwpe_tanh_dist": 0,
          "offdiag_dist": 50,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [
            "brec_str_0",
            "brec_str_1",
            "brec_str_2",
            "brec_str_3",
            "brec_str_4",
            "brec_str_5",
            "brec_str_6",
            "brec_str_7",
            "brec_str_8",
            "brec_str_9",
            "brec_str_10",
            "brec_str_11",
            "brec_str_12",
            "brec_str_13",
            "brec_str_14",
            "brec_str_15",
            "brec_str_16",
            "brec_str_17",
            "brec_str_18",
            "brec_str_19",
            "brec_str_20",
            "brec_str_21",
            "brec_str_22",
            "brec_str_23",
            "brec_str_24",
            "brec_str_25",
            "brec_str_26",
            "brec_str_27",
            "brec_str_28",
            "brec_str_29",
            "brec_str_30",
            "brec_str_31",
            "brec_str_32",
            "brec_str_33",
            "brec_str_34",
            "brec_str_35",
            "brec_str_36",
            "brec_str_37",
            "brec_str_38",
            "brec_str_39",
            "brec_str_40",
            "brec_str_41",
            "brec_str_42",
            "brec_str_43",
            "brec_str_44",
            "brec_str_45",
            "brec_str_46",
            "brec_str_47",
            "brec_str_48",
            "brec_str_49"
          ],
          "both": []
        },
        "BREC_Extension": {
          "total": 100,
          "rwpe_dist": 100,
          "nrwpe_tanh_dist": 100,
          "offdiag_dist": 100,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [],
          "both": [
            "brec_extension_0",
            "brec_extension_1",
            "brec_extension_2",
            "brec_extension_3",
            "brec_extension_4",
            "brec_extension_5",
            "brec_extension_6",
            "brec_extension_7",
            "brec_extension_8",
            "brec_extension_9",
            "brec_extension_10",
            "brec_extension_11",
            "brec_extension_12",
            "brec_extension_13",
            "brec_extension_14",
            "brec_extension_15",
            "brec_extension_16",
            "brec_extension_17",
            "brec_extension_18",
            "brec_extension_19",
            "brec_extension_20",
            "brec_extension_21",
            "brec_extension_22",
            "brec_extension_23",
            "brec_extension_24",
            "brec_extension_25",
            "brec_extension_26",
            "brec_extension_27",
            "brec_extension_28",
            "brec_extension_29",
            "brec_extension_30",
            "brec_extension_31",
            "brec_extension_32",
            "brec_extension_33",
            "brec_extension_34",
            "brec_extension_35",
            "brec_extension_36",
            "brec_extension_37",
            "brec_extension_38",
            "brec_extension_39",
            "brec_extension_40",
            "brec_extension_41",
            "brec_extension_42",
            "brec_extension_43",
            "brec_extension_44",
            "brec_extension_45",
            "brec_extension_46",
            "brec_extension_47",
            "brec_extension_48",
            "brec_extension_49",
            "brec_extension_50",
            "brec_extension_51",
            "brec_extension_52",
            "brec_extension_53",
            "brec_extension_54",
            "brec_extension_55",
            "brec_extension_56",
            "brec_extension_57",
            "brec_extension_58",
            "brec_extension_59",
            "brec_extension_60",
            "brec_extension_61",
            "brec_extension_62",
            "brec_extension_63",
            "brec_extension_64",
            "brec_extension_65",
            "brec_extension_66",
            "brec_extension_67",
            "brec_extension_68",
            "brec_extension_69",
            "brec_extension_70",
            "brec_extension_71",
            "brec_extension_72",
            "brec_extension_73",
            "brec_extension_74",
            "brec_extension_75",
            "brec_extension_76",
            "brec_extension_77",
            "brec_extension_78",
            "brec_extension_79",
            "brec_extension_80",
            "brec_extension_81",
            "brec_extension_82",
            "brec_extension_83",
            "brec_extension_84",
            "brec_extension_85",
            "brec_extension_86",
            "brec_extension_87",
            "brec_extension_88",
            "brec_extension_89",
            "brec_extension_90",
            "brec_extension_91",
            "brec_extension_92",
            "brec_extension_93",
            "brec_extension_94",
            "brec_extension_95",
            "brec_extension_96",
            "brec_extension_97",
            "brec_extension_98",
            "brec_extension_99"
          ]
        },
        "BREC_CFI": {
          "total": 100,
          "rwpe_dist": 9,
          "nrwpe_tanh_dist": 16,
          "offdiag_dist": 100,
          "nrwpe_only": [
            "brec_cfi_11",
            "brec_cfi_12",
            "brec_cfi_13",
            "brec_cfi_21",
            "brec_cfi_27",
            "brec_cfi_31",
            "brec_cfi_34",
            "brec_cfi_36",
            "brec_cfi_47"
          ],
          "rwpe_only": [],
          "neither": [
            "brec_cfi_0",
            "brec_cfi_1",
            "brec_cfi_2",
            "brec_cfi_3",
            "brec_cfi_4",
            "brec_cfi_6",
            "brec_cfi_7",
            "brec_cfi_8",
            "brec_cfi_9",
            "brec_cfi_10",
            "brec_cfi_14",
            "brec_cfi_15",
            "brec_cfi_16",
            "brec_cfi_17",
            "brec_cfi_20",
            "brec_cfi_22",
            "brec_cfi_23",
            "brec_cfi_24",
            "brec_cfi_25",
            "brec_cfi_26",
            "brec_cfi_28",
            "brec_cfi_30",
            "brec_cfi_32",
            "brec_cfi_33",
            "brec_cfi_35",
            "brec_cfi_37",
            "brec_cfi_38",
            "brec_cfi_39",
            "brec_cfi_41",
            "brec_cfi_42",
            "brec_cfi_43",
            "brec_cfi_44",
            "brec_cfi_46",
            "brec_cfi_48",
            "brec_cfi_50",
            "brec_cfi_52",
            "brec_cfi_53",
            "brec_cfi_54",
            "brec_cfi_55",
            "brec_cfi_56",
            "brec_cfi_58",
            "brec_cfi_59",
            "brec_cfi_60",
            "brec_cfi_61",
            "brec_cfi_62",
            "brec_cfi_63",
            "brec_cfi_64",
            "brec_cfi_65",
            "brec_cfi_66",
            "brec_cfi_67",
            "brec_cfi_68",
            "brec_cfi_69",
            "brec_cfi_70",
            "brec_cfi_71",
            "brec_cfi_72",
            "brec_cfi_73",
            "brec_cfi_74",
            "brec_cfi_75",
            "brec_cfi_76",
            "brec_cfi_77",
            "brec_cfi_78",
            "brec_cfi_79",
            "brec_cfi_80",
            "brec_cfi_81",
            "brec_cfi_82",
            "brec_cfi_83",
            "brec_cfi_84",
            "brec_cfi_85",
            "brec_cfi_86",
            "brec_cfi_87",
            "brec_cfi_88",
            "brec_cfi_89",
            "brec_cfi_90",
            "brec_cfi_91",
            "brec_cfi_92",
            "brec_cfi_93",
            "brec_cfi_94",
            "brec_cfi_95",
            "brec_cfi_96",
            "brec_cfi_97",
            "brec_cfi_98",
            "brec_cfi_99"
          ],
          "both": [
            "brec_cfi_5",
            "brec_cfi_18",
            "brec_cfi_19",
            "brec_cfi_29",
            "brec_cfi_40",
            "brec_cfi_45",
            "brec_cfi_49",
            "brec_cfi_51",
            "brec_cfi_57"
          ]
        },
        "BREC_4Vertex": {
          "total": 20,
          "rwpe_dist": 0,
          "nrwpe_tanh_dist": 0,
          "offdiag_dist": 20,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [
            "brec_4vtx_0",
            "brec_4vtx_1",
            "brec_4vtx_2",
            "brec_4vtx_3",
            "brec_4vtx_4",
            "brec_4vtx_5",
            "brec_4vtx_6",
            "brec_4vtx_7",
            "brec_4vtx_8",
            "brec_4vtx_9",
            "brec_4vtx_10",
            "brec_4vtx_11",
            "brec_4vtx_12",
            "brec_4vtx_13",
            "brec_4vtx_14",
            "brec_4vtx_15",
            "brec_4vtx_16",
            "brec_4vtx_17",
            "brec_4vtx_18",
            "brec_4vtx_19"
          ],
          "both": []
        },
        "BREC_Distance_Regular": {
          "total": 20,
          "rwpe_dist": 0,
          "nrwpe_tanh_dist": 0,
          "offdiag_dist": 20,
          "nrwpe_only": [],
          "rwpe_only": [],
          "neither": [
            "brec_dr_0",
            "brec_dr_1",
            "brec_dr_2",
            "brec_dr_3",
            "brec_dr_4",
            "brec_dr_5",
            "brec_dr_6",
            "brec_dr_7",
            "brec_dr_8",
            "brec_dr_9",
            "brec_dr_10",
            "brec_dr_11",
            "brec_dr_12",
            "brec_dr_13",
            "brec_dr_14",
            "brec_dr_15",
            "brec_dr_16",
            "brec_dr_17",
            "brec_dr_18",
            "brec_dr_19"
          ],
          "both": []
        }
      },
      "nrwpe_only_pairs": [
        "brec_cfi_11",
        "brec_cfi_12",
        "brec_cfi_13",
        "brec_cfi_21",
        "brec_cfi_27",
        "brec_cfi_31",
        "brec_cfi_34",
        "brec_cfi_36",
        "brec_cfi_47"
      ],
      "rwpe_only_pairs": [],
      "both_pairs_count": 342,
      "neither_pairs_count": 174,
      "entrywise_power_sum_distinguishing": {
        "S_2": 64,
        "S_4": 64,
        "S_6": 64
      }
    },
    "symbolic_derivation_k14_c4k1": {
      "eigenvalues_K14": {
        "-2": 1,
        "2": 1,
        "0": 3
      },
      "eigenvalues_C4K1": {
        "-2": 1,
        "2": 1,
        "0": 3
      },
      "cospectral_verified": true,
      "Atilde_K14": "[[0, 1/2, 1/2, 1/2, 1/2], [1/2, 0, 0, 0, 0], [1/2, 0, 0, 0, 0], [1/2, 0, 0, 0, 0], [1/2, 0, 0, 0, 0]]",
      "Atilde_C4K1": "[[0, 1/2, 0, 1/2, 0], [1/2, 0, 1/2, 0, 0], [0, 1/2, 0, 1/2, 0], [1/2, 0, 1/2, 0, 0], [0, 0, 0, 0, 0]]",
      "rwpe_diag_comparison": {
        "k=1": {
          "K14_sorted_diag": [
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "C4K1_sorted_diag": [
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "multisets_match": true
        },
        "k=2": {
          "K14_sorted_diag": [
            "1/4",
            "1/4",
            "1/4",
            "1/4",
            "1"
          ],
          "C4K1_sorted_diag": [
            "0",
            "1/2",
            "1/2",
            "1/2",
            "1/2"
          ],
          "multisets_match": false
        },
        "k=3": {
          "K14_sorted_diag": [
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "C4K1_sorted_diag": [
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "multisets_match": true
        },
        "k=4": {
          "K14_sorted_diag": [
            "1/4",
            "1/4",
            "1/4",
            "1/4",
            "1"
          ],
          "C4K1_sorted_diag": [
            "0",
            "1/2",
            "1/2",
            "1/2",
            "1/2"
          ],
          "multisets_match": false
        },
        "k=5": {
          "K14_sorted_diag": [
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "C4K1_sorted_diag": [
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "multisets_match": true
        }
      },
      "tanh_taylor_order5": "2*t**5/15 - t**3/3 + t",
      "nrwpe_K14": {
        "node_0": {
          "step1_return": "0",
          "step2_return": "192377319/256000000"
        },
        "node_1": {
          "step1_return": "0",
          "step2_return": "59563317319/262144000000"
        },
        "node_2": {
          "step1_return": "0",
          "step2_return": "59563317319/262144000000"
        },
        "node_3": {
          "step1_return": "0",
          "step2_return": "59563317319/262144000000"
        },
        "node_4": {
          "step1_return": "0",
          "step2_return": "59563317319/262144000000"
        }
      },
      "nrwpe_C4K1": {
        "node_0": {
          "step1_return": "0",
          "step2_return": "3541765319/8192000000"
        },
        "node_1": {
          "step1_return": "0",
          "step2_return": "3541765319/8192000000"
        },
        "node_2": {
          "step1_return": "0",
          "step2_return": "3541765319/8192000000"
        },
        "node_3": {
          "step1_return": "0",
          "step2_return": "3541765319/8192000000"
        },
        "node_4": {
          "step1_return": "0",
          "step2_return": "0"
        }
      },
      "entrywise_power_sums": {
        "S2_K14": [
          "1/4",
          "1/4",
          "1/4",
          "1/4",
          "1"
        ],
        "S4_K14": [
          "1/16",
          "1/16",
          "1/16",
          "1/16",
          "1/4"
        ],
        "S2_C4K1": [
          "0",
          "1/2",
          "1/2",
          "1/2",
          "1/2"
        ],
        "S4_C4K1": [
          "0",
          "1/8",
          "1/8",
          "1/8",
          "1/8"
        ],
        "S2_multisets_match": false,
        "S4_multisets_match": false
      },
      "cross_term_analysis": {
        "description": "S_4(i) = sum_j Atilde_{ij}^4 vs [Atilde^4]_{ii} = sum_j (Atilde^2)_{ij}^2",
        "S4_K14": [
          "1/4",
          "1/16",
          "1/16",
          "1/16",
          "1/16"
        ],
        "A4_diag_K14": [
          "1",
          "1/4",
          "1/4",
          "1/4",
          "1/4"
        ],
        "S4_equals_A4_diag": false,
        "conclusion": "S_4(i) != [A^4]_{ii} in general - nRWPE captures distinct information"
      }
    },
    "taylor_expansion_analysis": {
      "nrwpe_step2_expansion": "For sigma(x) = x - x^3/3 + 2x^5/15 - ... (tanh Taylor):\nx_1[j] = sigma(Atilde_{ji}) = Atilde_{ij} - Atilde_{ij}^3/3 + 2*Atilde_{ij}^5/15 - ...\n(using Atilde symmetric: Atilde_{ji} = Atilde_{ij})\n\ninner_2[i] = sum_j Atilde_{ij} * x_1[j]\n           = sum_j Atilde_{ij} * (Atilde_{ij} - Atilde_{ij}^3/3 + ...)\n           = sum_j Atilde_{ij}^2 - (1/3)*sum_j Atilde_{ij}^4 + (2/15)*sum_j Atilde_{ij}^6 - ...\n           = S_2(i) - S_4(i)/3 + 2*S_6(i)/15 - ...\nwhere S_{2p}(i) = sum_j Atilde_{ij}^{2p}\n\nThen: x_2[i] = sigma(S_2 - S_4/3 + ...)\n             = (S_2 - S_4/3) - (S_2 - S_4/3)^3/3 + ...\n             ≈ S_2 - S_4/3 - S_2^3/3 + S_2^2*S_4/3 + ...",
      "key_comparison": {
        "RWPE_diag_captures": "[Atilde^k]_{ii} for k=1..K, i.e. matrix-power diagonals",
        "nRWPE_diag_captures": "S_2(i), S_4(i), S_6(i), S_2(i)^3, S_2(i)^2*S_4(i), ... (entrywise power sums and products)",
        "crucial_distinction": "[Atilde^4]_{ii} = sum_j (sum_m Atilde_{im}*Atilde_{mj})^2 involves 2-hop path products.\nS_4(i) = sum_j Atilde_{ij}^4 involves 4th power of DIRECT edge weights.\nThese are DIFFERENT quantities! S_4 is NOT recoverable from {[Atilde^k]_{ii}}."
      },
      "theorem": "For any analytic nonlinearity sigma with sigma'''(0) != 0, the nRWPE-diag x_2[i] depends on S_4(i) = sum_j Atilde_{ij}^4 which is not a function of {[Atilde^k]_{ii} : k in N}. Therefore nRWPE-diag is STRICTLY more expressive than RWPE-diag. However, both are spectrally invariant (functions of A = sum lambda_m P_m).",
      "hierarchy_placement": "RWPE-diag <= nRWPE-diag <= EPNN <= PSWL < 3-WL"
    },
    "nrwpe_only_pair_analysis": {
      "best_pair": "brec_cfi_12",
      "num_nodes": 38,
      "category": "BREC_CFI",
      "nrwpe_details": {
        "tanh": {
          "distinguishes": true,
          "max_difference": 1.8885855735187307e-09
        },
        "softplus": {
          "distinguishes": false,
          "max_difference": 1.531841320456806e-11
        },
        "relu": {
          "distinguishes": false,
          "max_difference": 5.551115123125783e-17
        },
        "cubic": {
          "distinguishes": true,
          "max_difference": 1.3622840884866538e-09
        }
      },
      "rwpe_max_diff": 8.673617379884035e-19,
      "entrywise_power_sums": {
        "S_2": {
          "distinguishes": false,
          "max_difference": 0.0
        },
        "S_4": {
          "distinguishes": false,
          "max_difference": 0.0
        },
        "S_6": {
          "distinguishes": false,
          "max_difference": 0.0
        }
      }
    },
    "srg_analysis": {
      "rook_degree": 6,
      "shrikhande_degree": 6,
      "both_6_regular": "True",
      "eigenvalues_rook": [
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        2.0,
        2.0,
        2.0,
        2.0,
        2.0,
        2.0,
        6.0
      ],
      "eigenvalues_shrikhande": [
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        -2.0,
        2.0,
        2.0,
        2.0,
        2.0,
        2.0,
        2.0,
        6.0
      ],
      "cospectral": true,
      "rwpe_distinguishes": false,
      "rwpe_max_diff": 1.3877787807814457e-17,
      "nrwpe_diag": {
        "tanh": {
          "distinguishes": false,
          "max_difference": 2.7755575615628914e-17
        },
        "softplus": {
          "distinguishes": false,
          "max_difference": 4.440892098500626e-16
        },
        "relu": {
          "distinguishes": false,
          "max_difference": 1.3877787807814457e-17
        },
        "cubic": {
          "distinguishes": false,
          "max_difference": 4.163336342344337e-17
        }
      },
      "offdiag_nrwpe_tanh_distinguishes": true,
      "offdiag_nrwpe_max_diff": 0.1651404129246294,
      "pair_level_nrwpe_distinguishes": true,
      "pair_level_nrwpe_max_diff": 0.1651404129246294,
      "equitable_partition_analysis": {
        "quotient_matrix": "Q = [[0,6,0],[1,2,3],[0,2,4]]",
        "lambda_equals_mu": true,
        "explanation": "For srg(16,6,2,2), starting from any node i, the partition {i}, N(i), V\\(N(i)∪{i}) is equitable with quotient Q. Since lambda=mu=2, rows 2 and 3 have the SAME number of neighbors in each class. Both graphs are vertex-transitive, so starting from any node gives the same partition quotient. Therefore nRWPE-diag = constant for all nodes, and that constant is the same for both graphs."
      },
      "edmd_distinguishes": false,
      "edmd_max_diff": 3.766947864747294e-11
    },
    "edmd_analysis_summary": {
      "total_analyzed": 288,
      "edmd_distinguishes_count": 286,
      "edmd_only_pairs": [
        "cospectral_5v_canonical",
        "cospectral_6v_0",
        "cospectral_6v_2",
        "cospectral_6v_3",
        "cospectral_6v_1",
        "cospectral_7v_0",
        "cospectral_6v_4",
        "cospectral_7v_2",
        "cospectral_7v_4",
        "cospectral_7v_1",
        "cospectral_7v_3",
        "cospectral_7v_5",
        "cospectral_7v_6",
        "cospectral_7v_8",
        "cospectral_7v_7",
        "cospectral_7v_10",
        "cospectral_7v_12",
        "cospectral_7v_11",
        "cospectral_7v_9",
        "cospectral_7v_13"
      ]
    },
    "conclusions": [
      "1. nRWPE IS spectrally invariant, correcting the original hypothesis claim",
      "2. nRWPE captures entrywise-power invariants S_{2p}(i) beyond RWPE's matrix-power diagonals",
      "3. nRWPE-only pairs found: 9 (pairs where nRWPE distinguishes but RWPE does not)",
      "4. RWPE distinguishes 342/525 pairs",
      "5. nRWPE(tanh) distinguishes 349/525 pairs",
      "6. Off-diagonal nRWPE distinguishes 525/525 pairs",
      "7. EDMD distinguishes 286/288 analyzed pairs",
      "8. SRG pairs (Rook vs Shrikhande) defeat both RWPE and nRWPE via equitable partition collapse",
      "9. Total computation time: 133.5s"
    ],
    "computation_time_seconds": 133.47389340400696,
    "k_steps": 20,
    "threshold": 1e-10,
    "nonlinearities": [
      "tanh",
      "softplus",
      "relu",
      "cubic"
    ]
  },
  "datasets": [
    {
      "dataset": "graph_expressiveness_benchmark",
      "examples": [
        {
          "input": "{\"graph_A\": {\"num_nodes\": 5, \"num_edges\": 4, \"adjacency_matrix\": [[0, 1, 1, 1, 1], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0], [1, 0, 0, 0, 0]], \"edge_list\": [[0, 1], [0, 2], [0, 3], [0, 4]], \"degree_sequence\": [1, 1, 1, 1, 4], \"eigenvalues\": [-2.0, 0.0, 0.0, 0.0, 2.0]}, \"graph_B\": {\"num_nodes\": 5, \"num_edges\": 4, \"adjacency_matrix\": [[0, 1, 0, 1, 0], [1, 0, 1, 0, 0], [0, 1, 0, 1, 0], [1, 0, 1, 0, 0], [0, 0, 0, 0, 0]], \"edge_list\": [[0, 1], [0, 3], [1, 2], [2, 3]], \"degree_sequence\": [0, 2, 2, 2, 2], \"eigenvalues\": [-2.0, -0.0, 0.0, 0.0, 2.0]}}",
          "output": "{\"is_isomorphic\": false, \"are_cospectral\": true}",
          "predict_rwpe_diag": "distinguished",
          "predict_nrwpe_diag_any": "distinguished",
          "predict_offdiag_nrwpe": "distinguished",
          "predict_edmd": "distinguished",
          "metadata_pair_id": "cospectral_5v_canonical",
          "metadata_category": "cospectral",
          "metadata_subcategory": "5_vertex_canonical",
          "metadata_num_nodes_A": 5,
          "metadata_num_nodes_B": 5,
          "metadata_row_index": 0,
          "predict_nrwpe_tanh": "distinguished",
          "metadata_nrwpe_tanh_max_diff": 0.29608622384819666,
          "predict_nrwpe_softplus": "distinguished",
          "metadata_nrwpe_softplus_max_diff": 1.9697538720396213,
          "predict_nrwpe_relu": "distinguished",
          "metadata_nrwpe_relu_max_diff": 0.5000000000000022,
          "predict_nrwpe_cubic": "distinguished",
          "metadata_nrwpe_cubic_max_diff": 176.02553122110422,
          "metadata_rwpe_max_diff": 0.5000000000000022,
          "metadata_offdiag_max_diff": 0.7278944044432927
        },
        {
          "input": "{\"graph_A\": {\"num_nodes\": 6, \"num_edges\": 4, \"adjacency_matrix\": [[0, 0, 0, 1, 1, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 1], [0, 0, 0, 1, 1, 0]], \"edge_list\": [[0, 3], [0, 4], [3, 5], [4, 5]], \"degree_sequence\": [0, 0, 2, 2, 2, 2], \"eigenvalues\": [-2.0, -0.0, 0.0, 0.0, 0.0, 2.0]}, \"graph_B\": {\"num_nodes\": 6, \"num_edges\": 4, \"adjacency_matrix\": [[0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 0, 0]], \"edge_list\": [[0, 5], [1, 5], [2, 5], [3, 5]], \"degree_sequence\": [0, 1, 1, 1, 1, 4], \"eigenvalues\": [-2.0, 0.0, 0.0, 0.0, 0.0, 2.0]}}",
          "output": "{\"is_isomorphic\": false, \"are_cospectral\": true}",
          "predict_rwpe_diag": "distinguished",
          "predict_nrwpe_diag_any": "distinguished",
          "predict_offdiag_nrwpe": "distinguished",
          "predict_edmd": "distinguished",
          "metadata_pair_id": "cospectral_6v_0",
          "metadata_category": "cospectral",
          "metadata_subcategory": "6_vertex_atlas",
          "metadata_num_nodes_A": 6,
          "metadata_num_nodes_B": 6,
          "metadata_row_index": 1,
          "predict_nrwpe_tanh": "distinguished",
          "metadata_nrwpe_tanh_max_diff": 0.29608622384819666,
          "predict_nrwpe_softplus": "distinguished",
          "metadata_nrwpe_softplus_max_diff": 1.9697538720396213,
          "predict_nrwpe_relu": "distinguished",
          "metadata_nrwpe_relu_max_diff": 0.5000000000000022,
          "predict_nrwpe_cubic": "distinguished",
          "metadata_nrwpe_cubic_max_diff": 176.02553122110422,
          "metadata_rwpe_max_diff": 0.5000000000000022,
          "metadata_offdiag_max_diff": 0.46211715726000974
        },
        {
          "input": "{\"graph_A\": {\"num_nodes\": 6, \"num_edges\": 4, \"adjacency_matrix\": [[0, 0, 1, 0, 0, 0], [0, 0, 1, 1, 0, 0], [1, 1, 0, 0, 0, 0], [0, 1, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0], [0, 0, 0, 1, 0, 0]], \"edge_list\": [[0, 2], [1, 2], [1, 3], [3, 5]], \"degree_sequence\": [0, 1, 1, 2, 2, 2], \"eigenvalues\": [-1.73205081, -1.0, -0.0, 0.0, 1.0, 1.73205081]}, \"graph_B\": {\"num_nodes\": 6, \"num_edges\": 4, \"adjacency_matrix\": [[0, 0, 0, 1, 1, 1], [0, 0, 1, 0, 0, 0], [0, 1, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0]], \"edge_list\": [[0, 3], [0, 4], [0, 5], [1, 2]], \"degree_sequence\": [1, 1, 1, 1, 1, 3], \"eigenvalues\": [-1.73205081, -1.0, 0.0, 0.0, 1.0, 1.73205081]}}",
          "output": "{\"is_isomorphic\": false, \"are_cospectral\": true}",
          "predict_rwpe_diag": "distinguished",
          "predict_nrwpe_diag_any": "distinguished",
          "predict_offdiag_nrwpe": "distinguished",
          "predict_edmd": "distinguished",
          "metadata_pair_id": "cospectral_6v_1",
          "metadata_category": "cospectral",
          "metadata_subcategory": "6_vertex_atlas",
          "metadata_num_nodes_A": 6,
          "metadata_num_nodes_B": 6,
          "metadata_row_index": 2,
          "predict_nrwpe_tanh": "distinguished",
          "metadata_nrwpe_tanh_max_diff": 0.29190512497730875,
          "predict_nrwpe_softplus": "distinguished",
          "metadata_nrwpe_softplus_max_diff": 1.882115611291824,
          "predict_nrwpe_relu": "distinguished",
          "metadata_nrwpe_relu_max_diff": 0.5000000000000016,
          "predict_nrwpe_cubic": "distinguished",
          "metadata_nrwpe_cubic_max_diff": 176.66666666666666,
          "metadata_rwpe_max_diff": 0.5000000000000016,
          "metadata_offdiag_max_diff": 0.7615941559557649
        }
      ]
    }
  ]
}